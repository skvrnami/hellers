window.PuiTheme=window.PuiTheme||{};(function(a,b){a.ContextMenuButton=function(c){var d=this;d._options=b.extend({},d._defaults,c||{})};b.extend(a.ContextMenuButton,{_instances:{},_defaultInstance:"_default",initWidget:function(f,e,d){var c=a.ContextMenuButton._getInstance(d);if(typeof c==="undefined"){c=new a.ContextMenuButton(f);a.ContextMenuButton._setInstance(c,d)}c.init(e)},_getInstance:function(c){if(typeof c==="undefined"){c=a.ContextMenuButton._defaultInstance}return a.ContextMenuButton._instances[c]},_setInstance:function(c,d){if(typeof d==="undefined"){d=a.ContextMenuButton._defaultInstance}a.ContextMenuButton._instances[d]=c}});b.extend(a.ContextMenuButton.prototype,{_defaults:{selectors:{html:"html",component:".html-c-context-menu-button",dropdownToggle:".html-c-button .html-button",dropdownContainer:".html-b-context-container",dropdownMenuItem:".html-menu-item",dropdownMenuItemNotDisabled:".html-menu-item:not(.html-is-disabled)",buttonComponent:".html-c-button",buttonComponentNotDisabled:".html-c-button:not(.html-is-disabled)",button:".html-button",dropdownAlignmentRegEx:/html-has-dropdown-aligned-\w+/g},cssClasses:{isActive:"html-is-active",isDisabled:"html-is-disabled",isExpanded:"html-is-expanded",dropdownAlignment:"html-has-dropdown-aligned-"},animationDuration:0,dropdownOptions:{positionMy:"left top",positionAt:"left bottom",positionCollision:"fit flip",positionWithin:window}},_attributes:{ariaHidden:"aria-hidden"},_options:{},_eventNamespace:".ContextMenuButton",_initEvents:function(g){var e=this;var c=e._options;var d=c.selectors;var f=b(d.component,g);f.each(function(i,j){var h=b(j);e._initEventsDropdownToggle(h);e._initEventsKeyboardControl(h);e._initEventsDropdownMenuItem(h)});e._initEventsOutsideComponent()},_initEventsOutsideComponent:function(){var e=this;var c=e._options;var d=c.selectors;b(d.html).off("click"+e._eventNamespace).on("click"+e._eventNamespace,function(g){if(typeof g.originalEvent!=="undefined"&&typeof g.originalEvent._htmlDropdownButtonToggleEvent!=="undefined"){var f=g.originalEvent._htmlDropdownButtonToggleEvent}if(!f){e._closeAllDropdowns()}})},_initEventsDropdownToggle:function(c){var f=this;var d=f._options;var e=d.selectors;var g=c.find(e.dropdownToggle);g.off("click"+f._eventNamespace).on("click"+f._eventNamespace,function(h){f._toggleDropdown(c);h.originalEvent._htmlDropdownButtonToggleEvent=true;f._setFocusToTheFirstItem(c)}).off("keypress"+f._eventNamespace).on("keypress"+f._eventNamespace,function(h){if((h.which===b.ui.keyCode.ENTER)||(h.which===b.ui.keyCode.SPACE)||(h.which===b.ui.keyCode.DOWN)){f._toggleDropdown(c);f._setFocusToTheFirstItem(c)}})},_initEventsDropdownMenuItem:function(c){var g=this;var d=g._options;var f=d.selectors;var e=g._options.cssClasses;var h=c.find(f.dropdownToggle);var i=c.find(f.dropdownMenuItem);i.off("click"+g._eventNamespace).on("click"+g._eventNamespace,function(j){var k=b(this).closest(f.dropdownMenuItem);if(!k.hasClass(e.isDisabled)){h.focus();g._toggleDropdown(c);j.originalEvent._demoAdvancedComboToggleEvent=true}else{j.originalEvent._demoAdvancedComboToggleEvent=true}}).off("keypress"+g._eventNamespace).on("keypress"+g._eventNamespace,function(j){if((j.which===b.ui.keyCode.ENTER)||(j.which===b.ui.keyCode.SPACE)){g._toggleDropdown(c);h.focus();j.originalEvent._demoAdvancedComboToggleEvent=true}})},_initEventsKeyboardControl:function(c){var g=this;var e=g._options;var f=e.selectors;var i=c.find(f.dropdownToggle);var d=c.find(f.dropdownContainer);var h=d.find(f.dropdownMenuItem);h.off("keydown"+g._eventNamespace).on("keydown"+g._eventNamespace,function(l){var m=b(this).eq(0);var k=m.prevAll(f.dropdownMenuItemNotDisabled).eq(0);var j=m.nextAll(f.dropdownMenuItemNotDisabled).eq(0);if(l.which===b.ui.keyCode.DOWN&&j.length>0){j.focus();event.preventDefault()}if(l.which===b.ui.keyCode.DOWN&&j.length===0){event.preventDefault()}if(l.which===b.ui.keyCode.UP&&k.length>0){k.focus();event.preventDefault()}if(l.which===b.ui.keyCode.UP&&k.length===0){event.preventDefault()}if(l.which===b.ui.keyCode.TAB&&j.length===0){g._setFocusToTheFirstItem(c);event.preventDefault()}}).off("keyup"+g._eventNamespace).on("keyup"+g._eventNamespace,function(j){if(j.which===b.ui.keyCode.ESCAPE){g._closeAllDropdowns();i.focus()}})},_closeAllDropdowns:function(){var f=this;var c=f._attributes;var e=f._options.selectors;var d=f._options.cssClasses;var h=parseInt(f._options.animationDuration);var g=b(e.component);g.each(function(){var i=b(this);var k=i.find(e.buttonComponent);var j=i.find(e.dropdownContainer);j.fadeOut(h,function(){k.removeClass(d.isActive);i.removeClass(d.isExpanded).removeClass(function(l,m){return(m.match(e.dropdownAlignmentRegEx)||[]).join(" ")})})});g.find(d.dropdownContainer).attr(c.ariaHidden,"true")},_toggleDropdown:function(e){var f=this;var j=f._attributes;var i=f._options.selectors;var g=f._options.cssClasses;var h=parseInt(f._options.animationDuration);var l=e.find(i.buttonComponent);var k=e.hasClass(g.isDisabled);var d=e.hasClass(g.isExpanded);if(k){return}var c=e.find(i.dropdownContainer);c.fadeOut(h,function(){f._closeAllDropdowns()});if(!d){l.addClass(g.isActive);c.fadeIn(h,function(){e.addClass(g.isExpanded)});f._dropdownPosition(e)}c.attr(j.ariaHidden,d);return !d},_dropdownPosition:function(c){var g=this;var f=g._options.selectors;var e=g._options.cssClasses;var i=g._getComponentsPositionDataAttributes(c);var h=b.extend({},g._defaults.dropdownOptions,i||{});var d=c.find(f.dropdownContainer);c.removeClass(function(j,k){return(k.match(f.dropdownAlignmentRegEx)||[]).join(" ")});d.position({my:h.positionMy,at:h.positionAt,of:c,collision:h.positionCollision,within:h.positionWithin,using:function(o,j){var q;var l;var r=Math.round(j.element.left);var p=Math.round(j.element.left+j.element.width);var t=Math.round(j.element.top);var u=Math.round(j.element.top+j.element.height);var n=Math.round(j.target.left);var s=Math.round(j.target.left+j.target.width);var m=Math.round(j.target.top);var k=Math.round(j.target.top+j.target.height);if((r==n)&&(p!=s)){q="left"}else{if((p==s)&&(r!=n)){q="right"}else{if((r==n)&&(p==s)){q="center"}else{if((r>n)&&(p<s)){q="in-between-horizontal"}}}}if((t==k)&&(u!=k)){l="bottom"}else{if((u==m)&&(t!=m)){l="top"}else{if((t==m)&&(u==k)){l="middle"}else{if((t>m)&&(u<k)){l="in-between-vertical"}}}}b(this).css(o);b(this).closest(f.component).addClass(e.dropdownAlignment+q).addClass(e.dropdownAlignment+l)}})},_setFocusToTheFirstItem:function(c){var g=this;var f=g._options.selectors;var d=c.find(f.dropdownContainer);var e=d.find(f.dropdownMenuItemNotDisabled);e.eq(0).focus()},_getComponentsPositionDataAttributes:function(c){var f=["positionMy","positionAt","positionCollision","positionWithin"];var g=c.data();var h={};for(var e in g){for(var d in f){if(e===f[d]){h[e]=g[e]}}}return h},init:function(c){var d=this;var e=b(c);d._initEvents(e)}});a.EventDomReady.subscribe("prj1136Html",{},function(g,d){var f=a.ContextMenuButton;if(typeof f!=="undefined"){var c={};f.initWidget(c,d)}})})(window.PuiTheme,jQuery);