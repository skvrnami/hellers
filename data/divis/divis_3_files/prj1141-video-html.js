window.PuiTheme=window.PuiTheme||{};(function(a,b){a.VideoHtml=function(c){var d=this;d._options=b.extend(true,{},d._defaults,c||{})};b.extend(a.VideoHtml,{_instances:{},_defaultInstance:"_default",initWidget:function(f,e,d){var c=a.VideoHtml._getInstance(d);if(typeof c==="undefined"){c=new a.VideoHtml(f);a.VideoHtml._setInstance(c,d)}c.init(e);return c},_getInstance:function(c){if(typeof c==="undefined"){c=a.VideoHtml._defaultInstance}return a.VideoHtml._instances[c]},_setInstance:function(c,d){if(typeof d==="undefined"){d=a.VideoHtml._defaultInstance}a.VideoHtml._instances[d]=c}});b.extend(a.VideoHtml.prototype,{_defaults:{selectors:{html:"html",component:".html-c-video",video:".html-video",videoItem:".html-b-video-item",videoItemHeading:".html-b-video-item-heading",videoItemContent:".html-b-video-item-content",loadingIndicator:".html-c-loading-indicator",error:".html-b-error"},cssClasses:{inProgress:"html-is-in-progress",hasError:"html-has-error"}},_options:{},_eventNamespace:".VideoHtml",_initEvents:function(f){var e=this;var c=e._options;var d=c.selectors;e._initVideoEvents(f);e._initVideoSourcesEvents(f);e._initVideoEventsExternal(f)},_getDataAttributes:function(c){var f=this;var d=f._options;var e=d.selectors;return c.data()},_initMarkupEnhancement:function(c){var e=this;var d=c;var f="<div class='html-component html-c-loading-indicator'><div class='html-indicator'></div></div>";d.prepend(f)},_initVideoEvents:function(u){var c=this;var d=c._options;var f=d.selectors;var s=d.cssClasses;var q=u[0];var m=b(f.video,u)[0];var p=q.id;var h=u.find(f.loadingIndicator);m.addEventListener("error",k);m.addEventListener("play",j);m.addEventListener("playing",g);m.addEventListener("timeupdate",t);m.addEventListener("ended",n);m.addEventListener("canplay",i);m.addEventListener("canplaythrough",l);m.addEventListener("loadstart",v);m.addEventListener("waiting",r);m.addEventListener("stalled",e);m.addEventListener("durationchange",o);function k(w){u.trigger("errorEvent"+c._eventNamespace,{videoId:p,data:c._getDataAttributes(u),event:w});c._createError(u);h.removeClass(s.inProgress)}function j(w){u.trigger("playEvent"+c._eventNamespace,{videoId:p,data:c._getDataAttributes(u),event:w})}function g(w){u.trigger("playingEvent"+c._eventNamespace,{videoId:p,data:c._getDataAttributes(u),event:w});h.removeClass(s.inProgress)}function r(w){u.trigger("waitingEvent"+c._eventNamespace,{videoId:p,data:c._getDataAttributes(u),event:w});h.addClass(s.inProgress)}function e(w){u.trigger("stalledEvent"+c._eventNamespace,{videoId:p,data:c._getDataAttributes(u),event:w});h.addClass(s.inProgress)}function t(w){u.trigger("timeUpdateEvent"+c._eventNamespace,{videoId:p,currentTime:m.currentTime,data:c._getDataAttributes(u),event:w})}function n(w){u.trigger("endedEvent"+c._eventNamespace,{videoId:p,data:c._getDataAttributes(u),event:w})}function i(w){u.trigger("canPlayEvent"+c._eventNamespace,{videoId:p,data:c._getDataAttributes(u),event:w});h.removeClass(s.inProgress)}function l(w){u.trigger("canPlayThroughEvent"+c._eventNamespace,{videoId:p,data:c._getDataAttributes(u),event:w})}function v(w){u.trigger("loadStartEvent"+c._eventNamespace,{videoId:p,data:c._getDataAttributes(u),event:w});h.addClass(s.inProgress)}function o(w){u.trigger("durationChangeEvent"+c._eventNamespace,{videoId:p,data:c._getDataAttributes(u),event:w})}},_initVideoSourcesEvents:function(c){var d=this;var k=d._options;var i=k.selectors;var e=k.cssClasses;var g=c.find("source");var j=c;var h=j.attr("id");g.last().on("error",f);function f(l){c.trigger("errorEvent"+d._eventNamespace,{videoId:h,data:d._getDataAttributes(c),event:l});d._createError(c)}},_createError:function(c){var j=this;var g=j._options;var i=g.selectors;var h=g.cssClasses;var f=c;f.addClass(h.hasError);var e=c.find(i.error);if(!e){var d="<div class='html-b-error'></div>";f.prepend(d)}},_initVideoEventsExternal:function(c){var d=this;var k=d._options;var g=k.selectors;var e=k.cssClasses;var i=c;var h=c.find(g.video)[0];var f=i.attr("id");var j=c.find(g.loadingIndicator);c.off("play"+d._eventNamespace).on("play"+d._eventNamespace,function(m,l){if(!i.hasClass(e.hasError)){if(l.timestamp||l.timestamp===0){if(l.timestamp!==0){h.currentTime=l.timestamp/1000}else{h.currentTime=l.timestamp}}if(h.readyState===0){j.addClass(e.inProgress)}h.play()}}).off("pause"+d._eventNamespace).on("pause"+d._eventNamespace,function(m,l){h.pause()}).off("stop"+d._eventNamespace).on("stop"+d._eventNamespace,function(m,l){h.currentTime=0;h.pause()}).off("startPreload"+d._eventNamespace).on("startPreload"+d._eventNamespace,function(m,l){if(h.preload!=="auto"){h.preload="auto";var o=(/Trident.*rv\:11\./i.test(navigator.userAgent));var n=(/Edge\/\d./i.test(navigator.userAgent));if(o||n){h.play();h.pause()}}c.trigger("preloadEvent"+d._eventNamespace,{videoId:f,data:d._getDataAttributes(c),preload:"auto"})})},init:function(c){var d=this;var e=b(c);d._initMarkupEnhancement(e);d._initEvents(e)}})})(window.PuiTheme,jQuery);