window.PuiTheme=window.PuiTheme||{};(function(a,b){a.Header=function(){this._init()};b.extend(a.Header.prototype,{_defaults:{selectors:{header:".pui-m-header-main",headerContent:".html-b-header-content",searchArea:".html-c-search-fulltext",searchInput:"#html-header-search",buttonSearch:".html-b-header-search-button",buttonSearchToggle:".html-header-search-toggle",buttonSearchHide:".html-search-fulltext-close",footerContent:"footer .html-b-lists",footerBox:".html-b-footer-box",footerBoxTitle:".html-b-footer-box h3",footerBoxTitleLink:".html-b-footer-box h3 a",mainSubmenu:".html-b-mainmenu-item .html-b-submenu",mainMenuItem:".html-b-mainmenu-item",mainMenuLink:".html-b-mainmenu-item > .html-link",subLink:".html-visible-sub",extraList:".html-b-header-extra-list",extraSubmenu:".html-b-header-extra .html-b-submenu",extraSubmenuLink:".html-b-header-extra-list > .html-b-item > .html-link",buttonMobileMenu:".html-mainmenu-toggle",mobileMenu:".html-b-mainmenu-wrapper",topbarSegmentsList:".html-topbar-list.html-topbar-is-segments",topbarSegmentsListLink:".html-topbar-link",html:"html",body:"body",headerElements:".html-b-header-content",topbarElements:".html-b-topbar",submenu:".html-b-submenu",searchInputWrapper:".html-b-search-input-wrapper",overlayVisibility:'html[class*="pui-segment"]',headerSmartbankingPromo:".pui-modal-header-smartbanking-promo",agreeCloseParentModal:".pui-js-agree-close-parent-modal",closeParentModal:".pui-js-close-parent-modal"},changeClasses:{activeElement:"html-is-active",hiddenElement:"html-is-hidden",fixedElement:"html-is-fixed",touchDevice:"html-has-touch",headerSearchActive:"html-is-search-active",showOverlay:"html-has-overlay",searchVisible:"html-search-visible",openedMenu:"html-is-menu-opened",menuHasChild:"html-has-child",menuHasTransition:"html-has-transition",menuHasMobileMainMenu:"html-has-mobile-mainmenu",hasAnimations:{headerUp:"html-has-animation-header-up",headerDown:"html-has-animation-header-down"},promoForceOpen:"pui-js-force-open"},events:{toggleSearch:".htmlToggleSearch"},elements:{overlay:'<div class="html-overlay"></div>',mobileMenuIcon:'<span class="html-mainmenu-toggle-icon"></span>'},animationDuration:{header:300}},_targetBreakpoint:null,_init:function(){var f=this;var e=b(f._defaults.selectors.header);if(e.length===0){return}var h=e.find(f._defaults.selectors.extraSubmenuLink);var g=e.find(f._defaults.selectors.buttonSearchToggle);var d=e.find(f._defaults.selectors.mainMenuLink);var c=e.find(f._defaults.selectors.topbarSegmentsListLink);f._appendOverlay();f._appendMobileMenuIcon();f._searchActions();f._mainMenuActions();f._extraMenuActions();f._initTargetBreakpoint();f._mobileMenuActions();f._topbarMenuAction();f._leaveHeader();f._fixedMobileHeader();f._bindExtraSubmenuFocus(h);f._bindExtraSubmenuFocus(g);f._bindExtraSubmenuFocus(d);f._bindExtraSubmenuFocus(c)},_resetHeader:function(i,e){var c=this;var j=c._defaults.selectors;var k=c._defaults.changeClasses;var d=b(j.topbarSegmentsList);if(i!=="topbarmenu"&&e===true){d.removeClass(k.openedMenu);b(j.topbarSegmentsListLink).blur()}if(i!=="mainmenu"&&e===true){b(j.mainMenuItem).removeClass(k.openedMenu);b(j.mainMenuLink).blur();b(j.mainSubmenu).removeClass(k.activeElement)}var f=b(j.extraSubmenuLink);var l=b(j.extraSubmenu);if(i!=="extramenu"&&e===true){f.removeClass(k.activeElement).blur();l.removeClass(k.activeElement)}else{if(bowser&&(!bowser.android&&!bowser.ios&&!bowser.windowsphone)){f.removeClass(k.activeElement).blur();l.removeClass(k.activeElement)}}if(i!=="search"&&e===true){b(j.searchArea).removeClass(k.activeElement);b(j.header).removeClass(k.headerSearchActive);b(j.buttonSearchToggle).removeClass(k.activeElement)}var h=!(d.hasClass(k.openedMenu));h=h&&!(b(j.extraSubmenu).hasClass(k.activeElement));h=h&&!(b(j.buttonSearchToggle).hasClass(k.activeElement));var g=i==="mobilemenu"&&e===true;if(h||g){c._hideOverlay()}},_appendOverlay:function(){var d=this;var c=d._defaults.selectors;var e=d._defaults.elements;b(c.body).append(b(e.overlay))},_showOverlay:function(){var e=this;var d=e._defaults.selectors;var c=e._defaults.changeClasses;b(d.html).addClass(c.showOverlay)},_hideOverlay:function(){var e=this;var d=e._defaults.selectors;var c=e._defaults.changeClasses;b(d.html).removeClass(c.showOverlay)},_leaveHeader:function(){var d=this;var c=d._defaults.selectors;b(c.headerContent).off("mouseleave.psp.headerContent").on("mouseleave.psp.headerContent",function(){d._resetHeader(undefined,false)})},_searchActions:function(){var e=this;var d=e._defaults.selectors;var c=e._defaults.changeClasses;b(d.buttonSearchToggle).off("click.psp.searchArea").on("click.psp.searchArea",function(){var f=b(this);var g=f.hasClass(c.activeElement);if(g){e._searchHide()}else{e._searchShow()}});b(d.buttonSearchHide).off("click.psp.searchArea").on("click.psp.searchArea",function(){e._searchHide()})},_searchShow:function(){var e=this;var d=e._defaults.selectors;var c=e._defaults.changeClasses;var f=b(d.buttonSearchToggle);e._resetHeader("search",true);b(d.searchArea).addClass(c.activeElement);b(d.header).addClass(c.headerSearchActive);e._showOverlay();f.addClass(c.activeElement);b(d.searchInput).focus();b(d.buttonMobileMenu).removeClass(c.activeElement);b(d.mobileMenu).removeClass(c.activeElement);b(d.headerElements).removeClass(c.openedMenu);b(d.topbarElements).removeClass(c.openedMenu)},_searchHide:function(){var e=this;var d=e._defaults.selectors;var c=e._defaults.changeClasses;var f=b(d.buttonSearchToggle);b(d.searchArea).removeClass(c.activeElement);b(d.header).removeClass(c.headerSearchActive);e._hideOverlay();f.removeClass(c.activeElement)},_mainMenuActions:function(){var e=this;var d=e._defaults.selectors;var c=e._defaults.changeClasses;b(d.mainMenuLink).off("click.psp.headerMainMenu").on("click.psp.headerMainMenu",function(f){var g=b(this).parent(d.mainMenuItem);if(g.hasClass(c.menuHasChild)){f.preventDefault();if(g.hasClass(c.openedMenu)){g.removeClass(c.openedMenu);b(d.mainMenuLink).removeClass(c.hiddenElement).removeClass(c.activeElement);g.children(d.submenu).removeClass(c.activeElement);b(d.mainSubmenu).removeClass(c.activeElement);b(d.extraSubmenu).removeClass(c.activeElement);b(d.html).removeClass(c.showOverlay)}else{e._resetHeader("mainmenu",true);g.addClass(c.openedMenu);b(d.mainMenuLink).addClass(c.hiddenElement).removeClass(c.activeElement);b(this).removeClass(c.hiddenElement);g.children(d.submenu).addClass(c.activeElement);b(d.html).addClass(c.showOverlay)}return false}else{return true}})},_extraMenuActions:function(){var f=this;var e=f._defaults.selectors;var d=f._defaults.changeClasses;var c=".npw.headerExtraMenu";b(e.extraSubmenuLink).on("click"+c,function(){if(b(this).hasClass(d.activeElement)){b(this).removeClass(d.activeElement);b(this).parent().children(e.submenu).removeClass(d.activeElement);b(e.mainSubmenuLink).removeClass(d.activeElement);b(e.extraSubmenu).removeClass(d.activeElement);b(e.overlayVisibility).removeClass(d.showOverlay)}else{f._resetHeader("extramenu",true);b(e.extraSubmenuLink).addClass(d.activeElement).focus();b(e.extraSubmenu).removeClass(d.activeElement);b(this).addClass(d.activeElement);b(e.extraSubmenu).removeClass(d.activeElement);b(e.extraSubmenu).removeClass(d.activeElement);b(this).parent().children(e.submenu).addClass(d.activeElement);b(e.overlayVisibility).addClass(d.showOverlay);b(e.buttonMobileMenu).removeClass(d.activeElement);b(e.mobileMenu).removeClass(d.activeElement);b(e.headerElements).removeClass(d.openedMenu);b(e.topbarElements).removeClass(d.openedMenu);if(typeof a.OverlaysDismissible!=="undefined"){if(bowser&&(bowser.android||bowser.ios||bowser.windowsphone)){var h=b(e.headerSmartbankingPromo);if(h.length>0){var l=b(h[0]);var j=l.attr("id");var n=l.data("dtr-form-id");var i=l.data("dtr-destination");var o={storageNamespace:PuiTheme.CONSTANTS.PUI_UI_MESSAGES__OVERLAYS,tracking:{enableTracking:true,trackingDataCustom:{formid:n},trackingClosingMethodHeaderButton:"X button",trackingClosingMethodEscapeKey:"ESC",trackingClosingMethodOutsideClick:"Outside click",trackingErrorType:"load failure",trackingOverlayFailed:"guidepostFailed",trackingOverlayDisplayed:"guidepostDisplayed",trackingOverlayCancelled:"guidepostCancelled"}};a.OverlaysDismissible.initWidget(o,l,j);var m=".overlays";var k=b(e.closeParentModal,l);k.off("click"+m).on("click"+m,function(){var p={};p.formid=n;p.action="guidepostCancelled";p.closingMethod="NO button";PuiTheme.OverlaysDismissible.close(j,p)});var g=b(e.agreeCloseParentModal,l);g.off("click"+m).on("click"+m,function(){var p={};p.formid=n;p.action="guidepostSent";p.destination=i;PuiTheme.OverlaysDismissible.close(j,p)});if(l.hasClass(d.promoForceOpen)){PuiTheme.OverlaysDismissible.revoke(j)}PuiTheme.OverlaysDismissible.open(j)}}}}});b(e.buttonMobileMenu).off("touchstart"+c).on("touchstart"+c,function(){b(e.header).addClass(d.touchDevice)})},_initTargetBreakpoint:function(){var e=this;var d=e._defaults.selectors;var c=window.getComputedStyle(document.querySelector(d.header),"::before").getPropertyValue("content");var f=c.replace('"breakpoint: ',"");e._targetBreakpoint=parseInt(f,10)},_mobileMenuActions:function(){var f=this;var e=f._defaults.selectors;var d=f._defaults.changeClasses;var c=".html.headerMenuActions";b(e.buttonMobileMenu).off("click"+c).on("click"+c,function(g){f._toggleMobileMenu();f._resetHeader("mobilemenu",true);if(!b(e.header).hasClass(d.fixedElement)){window.scroll(0,0)}b(e.mobileMenu).addClass(d.menuHasTransition);b(e.mobileMenu).on("transitionend",function(){b(e.mobileMenu).removeClass(d.menuHasTransition)});g.preventDefault()});b(e.buttonMobileMenu).off("touchstart"+c).on("touchstart"+c,function(){b(e.header).addClass(d.touchDevice)});b(e.subLink).off("click"+c).on("click"+c,function(){window.location.href=b(this).parent().attr("href")})},_appendMobileMenuIcon:function(){var d=this;var c=d._defaults.selectors;var e=d._defaults.elements;b(c.buttonMobileMenu).append(b(e.mobileMenuIcon))},_toggleMobileMenu:function(){var e=this;var d=e._defaults.selectors;var c=e._defaults.changeClasses;b(d.buttonMobileMenu).toggleClass(c.activeElement);b(d.mainMenuLink).removeClass(c.hiddenElement);b(d.mobileMenu).toggleClass(c.activeElement);b(d.headerElements).toggleClass(c.openedMenu);b(d.topbarElements).toggleClass(c.openedMenu);b(d.html).toggleClass(c.menuHasMobileMainMenu)},_fixedMobileHeader:function(){var f=this;var i=f._defaults.selectors;var j=f._defaults.changeClasses;var c=b(i.header);var g=b(i.headerContent);var e=b(i.topbarElements);var d=b(window);var h=0;var k=".html.fixedHeader";if(d.width()<=f._targetBreakpoint){d.off("scroll"+k).on("scroll"+k,function(){var l=d.scrollTop();if(l>e.height()&&l<h){c.addClass(j.fixedElement);g.removeClass(j.hasAnimations.headerUp).addClass(j.hasAnimations.headerDown)}else{if(l<=e.height()){c.removeClass(j.fixedElement)}else{g.removeClass(j.hasAnimations.headerDown).addClass(j.hasAnimations.headerUp);setTimeout(function(){c.removeClass(j.fixedElement)},f._defaults.animationDuration.header)}}h=l})}},_topbarMenuAction:function(){var h=this;var g=h._defaults.selectors;var d=h._defaults.changeClasses;var f=b(g.topbarSegmentsList);var e=f.find(g.topbarSegmentsListLink+"."+d.activeElement);var c=".html.topbarMenuAction";e.off("click"+c).on("click"+c,function(i){if(b(window).width()<=h._targetBreakpoint){i.preventDefault();f.toggleClass(d.openedMenu);if(f.hasClass(d.openedMenu)){if(b(g.buttonMobileMenu).hasClass(d.activeElement)){h._toggleMobileMenu()}h._resetHeader("topbarmenu",true);h._showOverlay()}else{h._hideOverlay()}b(window).resize(function(){if(f.hasClass(d.openedMenu)&&b(window).width()>h._targetBreakpoint){f.removeClass(d.openedMenu);h._hideOverlay()}})}})},_bindExtraSubmenuFocus:function(c){var g=this;var e=g._defaults.changeClasses;var f=g._defaults.selectors;var d=".html.headerMenuActions";c.off("focus"+d).on("focus"+d,function(){var h=b(this);if(!h.parents(f.extraList).length&&!h.parents(f.topbarSegmentsList).length){b(f.extraSubmenu).removeClass(e.activeElement);b(f.extraSubmenuLink).removeClass(e.activeElement);b(f.topbarSegmentsList).removeClass(e.openedMenu);b(f.overlayVisibility).removeClass(e.showOverlay)}})}});b(document).ready(function(){if(typeof a.Header!=="undefined"){new a.Header()}})})(window.PuiTheme,jQuery);