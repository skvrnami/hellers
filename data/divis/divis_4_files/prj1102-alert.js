window.PuiTheme=window.PuiTheme||{};(function(a,b){a.Alerts=function(c){this._init(c)};b.extend(a.Alerts.prototype,{_defaults:{defaultAlertId:"default",defaultAlertShowDelay:0,alertType:"defaultType",storageNamespace:"alerts",selectors:{alertBoxes:".html-c-alert",agreeButton:".pui-js-close",moreInfo:".pui-js-more-info"},classes:{isActive:"html-is-active",isInactive:"html-is-inactive",isTransparent:"html-is-transparent"},dataAttr:{alertId:"alert-id",alertShowDelay:"alert-show-delay"},eventNamespace:".alerts"},_config:null,_init:function(c){var d=this;d._config=b.extend(true,{},d._defaults,c||{});var e=b(d._config.selectors.alertBoxes);e.each(function(){var i=b(this);d._updateAlert(i);d._bindCloseAlert(i);if(d._config.alertType===PuiTheme.CONSTANTS.PUI_UI_MESSAGES__ALERTS_COOKIE){var g=i.find(d._config.selectors.moreInfo);var f=a.ThemeHelper.Url.parseUrl(window.location.href);var h={};h.il1="cookies-bar";h.from=f.pathname;d._updateLinkUrl(g,h)}})},_getAlertId:function(e){var d=this;var c=d._config.defaultAlertId;return e.data(d._config.dataAttr.alertId)||c},_getAlertShowDelay:function(c){var d=this;var f=d._config.defaultAlertShowDelay;var e=c.data(d._config.dataAttr.alertShowDelay);if(typeof e!=="number"){e=f}return e},_updateAlert:function(g){var e=this;var d=e._getAlertId(g);var f=e._getAlertShowDelay(g);var c=e._isAlertVisible(d);if(c){if(f>0){g.addClass(e._config.classes.isTransparent)}setTimeout(function(){g.addClass(e._config.classes.isActive);g.removeClass(e._config.classes.isInactive);g.removeClass(e._config.classes.isTransparent);if(e._config.alertType===PuiTheme.CONSTANTS.PUI_UI_MESSAGES__ALERTS_COOKIE){var h={};h.action="cookieBarImpression";e._callMeasure(h)}},f)}else{g.addClass(e._config.classes.isInactive);g.removeClass(e._config.classes.isActive)}},_bindCloseAlert:function(f){var e=this;var d=e._getAlertId(f);var c=b(e._config.selectors.agreeButton,f);c.off("click"+e._config.eventNamespace).on("click"+e._config.eventNamespace,function(){e._setAlertVisible(d,false);e._updateAlert(f);if(e._config.alertType===PuiTheme.CONSTANTS.PUI_UI_MESSAGES__ALERTS_COOKIE){var g={};g.action="cookieBarAccepted";e._callMeasure(g)}})},_isAlertVisible:function(d){var e=this;var f=e._loadAlertData();var c=f[d];return typeof c==="undefined"||c},_setAlertVisible:function(c,f){var d=this;var e=d._loadAlertData();e[c]=f;d._storeAlertData(e)},_createCookie:function(e,f,g){var c;if(g){var d=new Date();d.setTime(d.getTime()+(g*24*60*60*1000));c="; expires="+d.toGMTString()}else{c=""}document.cookie=e+"="+f+c+"; path=/"},_readCookie:function(d){var c=d+"=";var g=document.cookie.split(";");for(var f=0;f<g.length;f++){var e=g[f];while(e.charAt(0)===" "){e=e.substring(1,e.length)}if(e.indexOf(c)===0){return e.substring(c.length,e.length)}}return undefined},_eraseCookie:function(c){var d=this;d._createCookie(c,"",-1)},_localStorageSafeRead:function(c){var f="";var d=this;try{f=localStorage[c];if(typeof f==="undefined"){throw ("localStorageEmpty")}}catch(e){if(console&&(typeof console.warn==="function")){if(e==="localStorageEmpty"){console.warn("localstorage EMPTY, trying to read cookies")}else{console.warn("localstorage read FAILED")}f=d._readCookie(c)}}return f},_localStorageSafeWrite:function(c,d){var e=this;try{localStorage[c]=d}catch(f){if(console&&(typeof console.warn==="function")){console.warn("localstorage write FAILED");e._createCookie(c,d,3000)}}},_storeAlertData:function(e){var d=this;var c=d._config.alertType;d._localStorageSafeWrite(c,JSON.stringify(e))},_loadAlertData:function(){var e=this;var c=e._config.alertType;var d=e._localStorageSafeRead(c);var g=null;try{g=JSON.parse(d)}catch(f){g={};e._storeAlertData(g)}return g},_callMeasure:function(d){if(typeof window.measure==="function"){try{window.measure(d)}catch(c){console.warn("Error while calling 'measure': "+c)}}},_updateLinkUrl:function(e,f){var d=e.attr("href");var c=a.ThemeHelper.Url.updateUrl(d,f);e.attr("href",c)}});b(function(){a.CookieAlerts=new a.Alerts({alertType:PuiTheme.CONSTANTS.PUI_UI_MESSAGES__ALERTS_COOKIE,selectors:{alertBoxes:".html-c-alert.html-alert-is-cookie",agreeButton:".html-c-button.pui-js-close",moreInfo:".pui-js-more-info"}});a.ErrorAlerts=new a.Alerts({alertType:PuiTheme.CONSTANTS.PUI_UI_MESSAGES__ALERTS_ERROR,selectors:{alertBoxes:".html-c-alert.html-is-global-error"}});if(bowser&&(bowser.android||bowser.ios||bowser.windowsphone)){a.MobileAppAlerts=new a.Alerts({alertType:PuiTheme.CONSTANTS.PUI_UI_MESSAGES__ALERTS_MOBILE,selectors:{alertBoxes:".html-c-alert.html-alert-is-mobile-app",agreeButton:".pui-js-close"}})}if(bowser){var c=b("body");if(bowser.android){c.addClass("pui-device-android")}if(bowser.ios){c.addClass("pui-device-ios")}if(bowser.windowsphone){c.addClass("pui-device-windowsphone")}}})})(window.PuiTheme,jQuery);